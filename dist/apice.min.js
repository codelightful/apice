var Apice=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?s(e):t}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=o(e);if(t){var r=o(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return c(this,n)}}function u(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||h(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=h(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function p(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,g(e,t,"get"))}function v(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,g(e,t,"set"),n),n}function g(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function y(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var m={isPromise:function(e){return e instanceof Promise},trim:function(e){return e?e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):""}},w=/\{(\d+)\}/g;m.placeholders=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var r={output:e,unbind:n};if("string"!=typeof e||!n||0===n.length)return r;var o,a={},s=e.matchAll(w),c=f(s);try{for(c.s();!(o=c.n()).done;){var l=o.value,u=l[1];if(u&&!a[u]){a[u]=!0;var h=new RegExp("\\{"+u+"\\}","g"),d=n[u];void 0!==d&&(r.unbind[u]=null,r.output=r.output.replace(h,d))}}}catch(e){c.e(e)}finally{c.f()}return r.unbind=r.unbind.filter((function(e){return null!=e})),r};var b={set:function(e,t,n){if(e){"number"!=typeof n&&(console.warn("Invalid timespan has been provided. Setting the default value"),n=3600);var i=new Date;i.setTime(i.getTime()+1e3*n);var r=m.trim(e)+"="+t+"; expires="+i.toGMTString()+"; path=/";document.cookie=r}else console.warn("Unable to set a cookie without name")},get:function(e){if(!e)return null;for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var i=m.trim(t[n]);if(i){var r=i.split("=");if(m.trim(r[0])===e)return r[1]}}return null}},k={},E={loggers:{},levels:{fatal:{value:10,color:"#ff4444",label:"FATAL"},error:{value:20,color:"#ff4444",label:"ERROR"},warn:{value:30,color:"#ff8800",label:"WARN"},info:{value:40,color:"#0099cc",label:"INFO"},debug:{value:50,color:"#3E4551",label:"DEBUG"},trace:{value:60,color:"#3E4551",label:"TRACE"}}},M=b.get("apice.logger.level");M?(E.globalLevel=E.levels[M],E.globalLevel||(E.globalLevel=E.levels.warn)):E.globalLevel=E.levels.warn;var W=new WeakMap,T=new WeakMap,_=new WeakSet,S=function(){function e(n){t(this,e),_.add(this),W.set(this,{writable:!0,value:void 0}),T.set(this,{writable:!0,value:void 0}),v(this,W,n);var i=b.get("apice.logger.["+n+"].level");i?(v(this,T,E.levels[i]),p(this,T)||v(this,T,E.globalLevel)):v(this,T,E.globalLevel)}return i(e,[{key:"name",get:function(){return p(this,W)}},{key:"level",value:function(){if(0!==arguments.length){var e=E.levels[arguments[0]];if(!e)throw new Error("apice.logger.invalid_level["+arguments[0]+"]");v(this,T,e),b.set("apice.logger.["+p(this,W)+"].level",arguments[0],1800)}return p(this,T).label}},{key:"fatal",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=y(this,_,x)).call.apply(t,[this,E.levels.fatal,e].concat(i))}},{key:"error",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=y(this,_,x)).call.apply(t,[this,E.levels.error,e].concat(i))}},{key:"warn",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=y(this,_,x)).call.apply(t,[this,E.levels.warn,e].concat(i))}},{key:"info",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=y(this,_,x)).call.apply(t,[this,E.levels.info,e].concat(i))}},{key:"debug",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=y(this,_,x)).call.apply(t,[this,E.levels.debug,e].concat(i))}},{key:"trace",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];(t=y(this,_,x)).call.apply(t,[this,E.levels.trace,e].concat(i))}}]),e}();function x(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(p(this,T).value>=e.value){var o;if("string"!=typeof t)t=JSON.stringify(t);else if(i&&i.length>0){var a=m.placeholders.apply(m,[t].concat(u(i)));t=a.output,i=a.unbind}(o=console).log.apply(o,["%c["+e.label+"]["+p(this,W)+"]: "+t].concat(["color: "+e.color].concat(u(i))))}}function A(e,t,n){if(!e)throw new Error("apice.util.event.add.invalid_target");if(!t||"string"!=typeof t)throw new Error("apice.util.event.add.invalid_event_name");"function"==typeof n&&("function"==typeof e.each?e.each((function(e){A(e,t,n)})):"function"==typeof e.addEventListener?e.addEventListener(t,n,!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n))}function L(e,t,n){if(!e)throw new Error("apice.util.event.remove.invalid_target");if(!t||"string"!=typeof t)throw new Error("apice.util.event.remove.invalid_event_name");"function"==typeof n&&("function"==typeof e.each?e.each((function(e){L(e,t,n)})):"function"==typeof e.removeEventListener?e.removeEventListener(t,n):"function"==typeof e.detachEvent&&e.detachEvent("on"+t,n))}k.getLogger=function(e){return e||(e="system"),E.loggers[e]||(E.loggers[e]=new S(e)),E.loggers[e]},k.level=function(){var e;if(1===arguments.length){var t=E.levels[arguments[0]];if(!t)throw new Error("apice.logger.invalid_level["+arguments[0]+"]");for(var n in E.globalLevel=t,b.set("apice.logger.level",arguments[0],1800),E.loggers){var i=E.loggers[n];i.level(arguments[0])}}else if(2===arguments.length){var r=k.getLogger(arguments[1]);return r.level(arguments[0]),r.level()}return null===(e=E.globalLevel)||void 0===e?void 0:e.label};var C={addListener:A,removeListener:L,documentReady:function(e){"complete"===document.readyState?e():"function"==typeof document.addEventListener?document.addEventListener("DOMContentLoaded",e,!1):"function"==typeof document.attachEvent&&document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&e()}))},waitAnimation:function(e,t,n){A(e,"animationend",(function t(){L(e,"animationend",t),n()})),"function"==typeof e.setClass?e.setClass(t):e.className=t}},P={};function N(e){if(!e||"string"!=typeof e)return null;var t=document.createElement("div");return t.innerHTML=e,u(t.childNodes)}var R=function e(){t(this,e)},q=new WeakMap,j=new WeakMap,H=function(e){r(o,e);var n=l(o);function o(e){var i;return t(this,o),i=n.call(this),q.set(s(i),{writable:!0,value:void 0}),j.set(s(i),{writable:!0,value:void 0}),v(s(i),q,e),v(s(i),j,{}),i}return i(o,[{key:"isValid",get:function(){return!!p(this,q)}},{key:"id",get:function(){return p(this,q)?p(this,q).id:null}},{key:"each",value:function(e){return"function"==typeof e&&p(this,q)&&e(p(this,q)),this}},{key:"content",value:function(){var e=this;if(0===arguments.length)return p(this,q)?p(this,q).innerHTML:null;if(p(this,q)){var t=arguments[0];t?D(t)?(p(this,q).innerHTML="",p(this,q).appendChild(t)):t instanceof R?(p(this,q).innerHTML="",t.each((function(t){p(e,q).append(t)}))):p(this,q).innerHTML=t:p(this,q).innerHTML=""}return this}},{key:"append",value:function(){var e=this;if(p(this,q)&&arguments.length>0)if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.append(arguments[t]);else{var n=arguments[0];if(n instanceof R)n.each((function(t){p(e,q).appendChild(t)}));else if("string"==typeof n){n=N(n);for(var i=0;i<n.length;i++)p(this,q).appendChild(n[i])}else if(D(n))p(this,q).appendChild(n);else if(n instanceof NodeList)for(var r=0;r<n.length;r++){var o=n[r];p(this,q).appendChild(o)}}return this}},{key:"prepend",value:function(){var e=this;if(p(this,q)&&arguments.length>0)if(arguments.length>1)for(var t=0;t<arguments.length;t++)this.prepend(arguments[t]);else{var n=p(this,q).firstChild,i=arguments[0];if(i instanceof R)i.each((function(t){p(e,q).insertBefore(t,n)}));else if("string"==typeof i){i=N(i);for(var r=0;r<i.length;r++)p(this,q).insertBefore(i[r],n)}else if(D(i))p(this,q).insertBefore(i,n);else if(i instanceof NodeList)for(var o=0;o<i.length;o++){var a=i[o];p(this,q).insertBefore(a,n)}}return this}},{key:"appendTo",value:function(e){(e=z(e))&&e.append(this)}},{key:"on",value:function(e,t){if(!e)throw new Error("apice.element.on.no_event_name");return p(this,q)&&"function"==typeof t&&C.addListener(p(this,q),e,t),this}},{key:"click",value:function(){return 0===arguments.length||"function"!=typeof arguments[0]||this.on("click",arguments[0]),this}},{key:"select",value:function(e){return e&&"string"==typeof e?U(p(this,q),e):null}},{key:"addClass",value:function(e){return e&&p(this,q).classList.add(e),this}},{key:"removeClass",value:function(e){return e&&p(this,q).classList.remove(e),this}},{key:"setClass",value:function(e){return e&&(p(this,q).className=e),this}},{key:"display",value:function(e){!0===e?p(this,j).originalDisplay?p(this,q).style.display=p(this,j).originalDisplay:p(this,q).style.display="block":(p(this,j).originalDisplay=p(this,q).style.display,p(this,q).style.display="none")}}]),o}(R),O=new WeakMap,I=new WeakSet,F=function(e){r(o,e);var n=l(o);function o(){var e;return t(this,o),e=n.call(this),I.add(s(e)),O.set(s(e),{writable:!0,value:void 0}),v(s(e),O,[]),e}return i(o,[{key:"add",value:function(e){return e&&p(this,O).push(e),this}},{key:"each",value:function(){return y(this,I,B).call(this,"each",arguments),this}},{key:"content",value:function(){return 0===arguments.length?y(this,I,B).call(this,"content",arguments):(y(this,I,B).call(this,"content",arguments),this)}},{key:"append",value:function(){return y(this,I,B).call(this,"append",arguments),this}},{key:"prepend",value:function(){return y(this,I,B).call(this,"prepend",arguments),this}},{key:"appendTo",value:function(){return y(this,I,B).call(this,"appendTo",arguments),this}},{key:"on",value:function(){return y(this,I,B).call(this,"on",arguments),this}},{key:"click",value:function(){return y(this,I,B).call(this,"click",arguments),this}},{key:"select",value:function(){return y(this,I,B).call(this,"select",arguments),this}},{key:"addClass",value:function(){return y(this,I,B).call(this,"addClass",arguments),this}},{key:"removeClass",value:function(){return y(this,I,B).call(this,"removeClass",arguments),this}},{key:"setClass",value:function(){return y(this,I,B).call(this,"setClass",arguments),this}},{key:"display",value:function(){return y(this,I,B).call(this,"display",arguments),this}}]),o}(R);function B(e,t){for(var n=[],i=0;i<p(this,O).length;i++){var r=p(this,O)[i],o=r[e];if("function"==typeof o)try{var a=o.apply(r,t);Array.isArray(a)?n.push.apply(n,u(a)):n.push(a)}catch(t){console.log("itaca.element.node_call[".concat(e,"]"),t)}}return n}function D(t){return t&&"object"===e(t)&&1===t.nodeType}function U(e,t){var n=e.querySelectorAll(t);if(0===n.length)return null;if(1===n.length)return new H(n[0]);for(var i=new F,r=0;r<n.length;r++){var o=n[r];i.add(new H(o))}return i}var z=function(e){return e?"body"===e||e===document.body?(P.bodySingleton||(P.bodySingleton=new H(document.body)),P.bodySingleton):"string"==typeof e?U(document,e):e instanceof R?e:D(e)?new H(e):null:null};function G(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function X(){return G()+G()}z.append=function(e,t){if(e&&t){if("body"===t||t===document.body)throw Error("apice.element.append.source_cannot_be_body");if("string"==typeof t){var n=t.charAt(0);if("#"===n||"."===n||"["===n){var i=document.querySelector(t);if(!i)throw Error("apice.element.append.unknown_source[".concat(t,"]"));t=i}}var r=z(e);if(!r)throw Error("apice.element.append.unknown_target[".concat(e,"]"));r.append(t)}},z.isApiceElement=function(e){return e&&e instanceof R};var J={tinyId:G,shortId:X,guid:function(){return X()+"-"+X()+"-"+X()+"-"+X()+X()}},$={},V=new WeakMap,K=new WeakMap,Q=new WeakMap,Y=new WeakMap,Z=new WeakMap,ee=new WeakSet,te=function(){function e(n){t(this,e),ee.add(this),V.set(this,{writable:!0,value:void 0}),K.set(this,{writable:!0,value:void 0}),Q.set(this,{writable:!0,value:void 0}),Y.set(this,{writable:!0,value:void 0}),Z.set(this,{writable:!0,value:void 0}),v(this,Z,J.guid()),v(this,K,n.message),v(this,Q,n.cause),v(this,V,n.module),v(this,Y,n.code)}return i(e,[{key:"guid",get:function(){return p(this,Z)}},{key:"message",get:function(){var e;return null!==(e=p(this,K))&&void 0!==e?e:"An error has occurred. Please contact the technical support without closing this screen."}},{key:"cause",get:function(){return p(this,Q)}},{key:"code",get:function(){return p(this,Y)}},{key:"log",value:function(){var e=k.getLogger(p(this,V)),t="ref=[".concat(p(this,Z),"]");p(this,K)&&(t+="\n-> ".concat(p(this,K))),p(this,Y)&&(t+="\n-> (c) ".concat(p(this,Y))),p(this,Q)&&(t+=y(this,ee,ne).call(this,p(this,Q))),e.error(t)}},{key:"render",value:function(e){this.log();var t=z(e);t?t.content('<div class="apc-badge apc-error">            <div class="apc-header">Atention!</div>            <div class="apc-body">'.concat(this.message,'</div>            <div class="apc-footer">').concat(p(this,Z),"</div>        </div>")):Apice.ui.toast.error("".concat(this.message,"<div>").concat(p(this,Z),"</div>"))}}]),e}();function ne(e){return e?"string"==typeof e?"\n-> (s) ".concat(e):e instanceof Error?"\n-> (e) ".concat(e.stack):p(this,Q)instanceof te?"\n-> (n) ".concat(e.code)+y(this,ee,ne).call(this,e.cause):p(this,Q)instanceof re?"\n-> (h) http-error[".concat(e.code,"]"):void 0:""}$.create=function(t){if(!t)return console.error("apice.error_handler.create.null_input"),null;var n=e(t);if("string"===n)t={code:t};else if(t instanceof Error)t={cause:t};else if("object"!==n)return console.error("apice.error_handler.create.invalid_input",t),null;return new te(t)},$.render=function(e,t){e&&(e instanceof te||(e=$.create(e)),e.render(t))};var ie=new WeakMap,re=function(){function e(n){t(this,e),ie.set(this,{writable:!0,value:void 0}),v(this,ie,n)}return i(e,[{key:"type",get:function(){return"http"}},{key:"code",get:function(){return p(this,ie)}}]),e}();$.createHttpError=function(e){return new re(e)},window.addEventListener("unhandledrejection",(function(e){e.reason instanceof te&&(e.preventDefault(),e.reason.render())}));var oe={},ae=k.getLogger("apice.http");function se(e,t,n){var i=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){throw Error("apice.http.xmlhttp_creation_error")}}}();return i.guid=J.shortId(),i.onreadystatechange=function(){if(4==i.readyState||"complete"===i.readyState)if(200==i.status){ae.trace("Successful HTTP response received. request={0}",i.guid);var r={};r.headers=function(e){var t={},n=e.getAllResponseHeaders();if(n){n=n.split("\r\n");for(var i=0;i<n.length;i++){var r=n[i].split(":");t[m.trim(r[0]).toLowerCase()]=m.trim(r[1])}}return t}(i),r.content=i.responseText,function(e,t,n,i){if("json"===i.output||!i.output&&"application/json"===t["content-type"])try{t.content=JSON.parse(t.content)}catch(i){ae.error("An error occurred parsing a HTTP JSON content. request={0}\r\nContent:\r\n{1}\r\n",e.guid,t.content,i),n($.create({code:"apice.http.json_parse_error",cause:i}))}}(i,r,t,n),e(r)}else ae.trace("Failed HTTP response. request={0} status={1}",i.guid,i.status),t($.createHttpError(i.status))},i}oe.request=function(e,t){return"string"==typeof e&&e?(t||(t={}),t.method||(t.method="GET"),new Promise((function(n,i){var r=se(n,i,t);ae.debug("Triggering http request. request={0} url={1}",r.guid,e),r.open(t.method,e,!1!==t.async),"GET"!==t.method&&t.data?r.send(t.data):r.send()}))):(ae.error("Unable to execute an HTTP request without an URL"),Promise.reject("apice.http.null_url"))},oe.loadScript=function(e){return new Promise((function(t,n){var i=document.createElement("script");i.src=e,i.type="text/javascript",i.async=!1,i.onerror=function(){n($.create({module:"apice.http",code:"apice.http.load_script_error[".concat(e,"]")}))},i.onload=function(){t()},document.head.appendChild(i)}))};var ce=new WeakMap,le=new WeakMap,ue=new WeakMap,he=new WeakMap,de=function(){function e(n,i,r,o){if(t(this,e),ce.set(this,{writable:!0,value:void 0}),le.set(this,{writable:!0,value:void 0}),ue.set(this,{writable:!0,value:void 0}),he.set(this,{writable:!0,value:void 0}),!p(this,le))throw new Error("apice.http.url.no_host");v(this,ce,null!=n?n:"https"),v(this,le,i),v(this,ue,null!=r?r:"80"),v(this,he,null!=o?o:"")}return i(e,[{key:"protocol",get:function(){return p(this,ce)}},{key:"host",get:function(){return p(this,le)}},{key:"port",get:function(){return p(this,ue)}},{key:"path",get:function(){return p(this,he)}},{key:"toString",value:function(){return p(this,ce)+"://"+p(this,le)+":"+p(this,ue)+"/"+p(this,he)}},{key:"resourceUrl",value:function(e,t,n){var i=this.toString();return e&&"string"==typeof e&&(i.endsWith("/")||e.startsWith("/")||(i+="/"),i+=e),t&&"string"==typeof t&&(t.startsWith("?")||(i+="?"),i+=t),n&&"string"==typeof n&&(n.startsWith("#")||(i+="#"),i+=n),i}},{key:"get",value:function(e,t,n){var i=this.resourceUrl(e,t,n);return oe.request(i,{method:"GET"})}},{key:"post",value:function(e,t){var n=this.resourceUrl(e);return oe.request(n,{method:"POST",data:t})}},{key:"put",value:function(e,t){var n=this.resourceUrl(e);return oe.request(n,{method:"PUT",data:t})}},{key:"delete",value:function(e,t){var n=this.resourceUrl(e);return oe.request(n,{method:"DELETE",data:t})}}]),e}(),fe=new WeakMap,pe=new WeakMap,ve=new WeakMap,ge=new WeakMap,ye=function(){function n(){t(this,n),fe.set(this,{writable:!0,value:void 0}),pe.set(this,{writable:!0,value:void 0}),ve.set(this,{writable:!0,value:void 0}),ge.set(this,{writable:!0,value:void 0})}return i(n,[{key:"protocol",value:function(e){return v(this,fe,e),this}},{key:"host",value:function(e){return v(this,pe,e),this}},{key:"port",value:function(t){var n=e(t);if("string"===n)v(this,ve,t);else{if("number"!==n)throw new Error("apice.http.url_builder.invalid_port");v(this,ve,String(t))}return this}},{key:"path",value:function(e){return v(this,ge,e),this}},{key:"build",value:function(){return new de(p(this,fe),p(this,pe),p(this,ve),p(this,ge))}}]),n}();oe.url=function(){return new ye};var me="apc.controller",we=k.getLogger(me),be={controllers:{}},ke=function(e){if("string"==typeof e){var t=be.controllers[e];if(!t)throw Error("apice.controller.unknown_controller[".concat(e,"]"));return t}},Ee=new WeakMap,Me=new WeakMap,We=new WeakSet,Te=new WeakSet,_e=function(){function n(e,i){t(this,n),Te.add(this),We.add(this),Ee.set(this,{writable:!0,value:void 0}),Me.set(this,{writable:!0,value:void 0}),v(this,Ee,e),v(this,Me,i)}return i(n,[{key:"name",get:function(){return p(this,Ee)}},{key:"declare",value:function(e){if("function"!=typeof e)throw new Error("apice.controller.declare.invalid_implementation[".concat(p(this,Ee),"]"));v(this,Me,e)}},{key:"serve",value:function(){var t=e(p(this,Me));return"function"===t?y(this,We,Se).call(this):"string"===t?y(this,Te,xe).call(this):Promise.reject($.create({module:me,code:"apice.controller.bad_implementation[".concat(p(this,Ee),"]")}))}}]),n}();function Se(){var e=this;return we.debug("Serving controller. controller={0}",p(this,Ee)),new Promise((function(t,n){try{p(e,Me).call(e),t()}catch(t){n($.create({module:me,cause:t,code:"apice.controller.serve.implementation_error[".concat(p(e,Ee),"]")}))}}))}function xe(){var e=this;return we.debug("Loading controller. controller={0}",p(this,Ee)),new Promise((function(t,n){oe.loadScript(p(e,Me)).then((function(){setTimeout((function(){"string"==typeof p(e,Me)?n("apice.controller.serve.undeclared[".concat(p(e,Ee),"]")):y(e,We,Se).call(e).then(t).catch(n)}),0)})).catch((function(t){n($.create({module:me,cause:t,code:"apice.controller.load_script_error[".concat(p(e,Ee),"]")}))}))}))}ke.register=function(e,t){we.debug("Registering controller. controller={0)",e);var n=new _e(e,t);return be.controllers[e]=n,n},ke.declare=function(e,t){we.debug("Declaring controller. controller={0}",e);var n=be.controllers[e];if(!n)throw Error("apice.controller.declare.unknown_controller[".concat(e,"]"));n.declare(t)},ke.isController=function(e){return e&&e instanceof _e};var Ae="apice.fragment",Le=k.getLogger(Ae),Ce={fragments:{}},Pe=new WeakMap,Ne=new WeakMap,Re=new WeakMap,qe=new WeakSet,je=function(){function e(n,i,r){t(this,e),qe.add(this),Pe.set(this,{writable:!0,value:void 0}),Ne.set(this,{writable:!0,value:void 0}),Re.set(this,{writable:!0,value:void 0}),v(this,Pe,n),v(this,Ne,i),v(this,Re,r)}return i(e,[{key:"name",get:function(){return p(this,Pe)}},{key:"render",value:function(e){var t=this;e||(e=document.body);var n=z(e);return n?(Le.debug("Serving fragment. fragment={0}",p(this,Pe)),new Promise((function(e,i){oe.request(p(t,Ne),{method:"GET"}).then((function(r){n.content(r.content),setTimeout((function(){y(t,qe,He).call(t).then(e).catch(i)}),0)})).catch((function(e){i($.create({module:Ae,message:"An error has occurred trying to load the content",cause:e,code:"apice.fragment.render_error[".concat(t.name,"]")}))}))}))):Promise.reject($.create({module:Ae,code:"apice.fragment.render.target_not_found[".concat(e,"]")}))}}]),e}();function He(){var t=this;return p(this,Re)?new Promise((function(n,i){var r=e(p(t,Re));if("function"===r){Le.debug("Serving fragment controller function. fragment={0}",p(t,Pe));try{p(t,Re).call(t),n()}catch(e){i($.create({module:Ae,cause:e,code:"apice.fragment.controller_function_error[".concat(p(t,Pe),"]")}))}}else"string"===r&&(Le.debug("Serving fragment controller. fragment={0} controller={1}",p(t,Pe),p(t,Re)),ke(p(t,Re)).serve().then(n).catch((function(e){i($.create({module:Ae,cause:e,code:"apice.fragment.controller_serve_error[".concat(t.name,"]")}))})))})):Promise.resolve()}var Oe=function(e){if("string"==typeof e){var t=Ce.fragments[e];if(!t)throw new Error("apice.fragment.unknown_fragment[".concat(e,"]"));return t}};Oe.register=function(e,t,n){Le.debug("Registering fragment. fragment={0}",e);var i=new je(e,t,n);return Ce.fragments[e]=i,i},Oe.isFragment=function(e){return e&&e instanceof je};var Ie="apice.router",Fe=k.getLogger(Ie),Be={},De={};function Ue(e){Fe.debug("Hash change triggered. event={0}",e);var t=Be.hash(),n=Be.match(t);if(n)Fe.debug("Serving route. pattern={0}",n.pattern);else if(!De.defaultRoute||t&&De.notFoundRoute){if(!De.notFoundRoute)return void $.render({module:Ie,message:"The requested resource was not found: "+t,code:"apice.router.no_matching_no_default"});Fe.warn("Route not found. Using no-found default routing. hash={0}",t),n=De.notFoundRoute}else t?Fe.warn("Route not found. Serving default hash={0}",t):Fe.debug("No hash found. Serving default router"),n=De.defaultRoute;n.serve(t)}De.routes=[],De.defaultRoute=null,De.notFoundRoute=null,De.target=null;var ze=new WeakMap,Ge=new WeakMap,Xe=new WeakMap,Je=new WeakSet,$e=function(){function e(n){if(t(this,e),Je.add(this),ze.set(this,{writable:!0,value:void 0}),Ge.set(this,{writable:!0,value:void 0}),Xe.set(this,{writable:!0,value:void 0}),!n||"string"!=typeof n)throw Error("apice.router.hah.invalid_pattern");v(this,ze,n),y(this,Je,Ve).call(this)}return i(e,[{key:"pattern",get:function(){return p(this,ze)}},{key:"count",get:function(){return p(this,Ge).length}},{key:"hasParameters",get:function(){return p(this,Xe).length>0}}]),e}();function Ve(){v(this,Ge,[]),v(this,Xe,[]);for(var e=p(this,ze).split("/"),t=0;t<e.length;t++){var n=e[t];n.startsWith(":")&&p(this,Xe).push(n.substr(1)),p(this,Ge).push(n)}}var Ke=new WeakMap,Qe=new WeakMap,Ye=function(){function e(n,i){if(t(this,e),Ke.set(this,{writable:!0,value:void 0}),Qe.set(this,{writable:!0,value:void 0}),!n||"string"!=typeof n)throw Error("apice.route.constructor.invalid_route_value");if(!i)throw Error("apice.route.constructor.missing_route_action");v(this,Ke,new $e(n)),v(this,Qe,i)}return i(e,[{key:"pattern",get:function(){return p(this,Ke).pattern}},{key:"asDefault",value:function(){De.defaultRoute=this}},{key:"asNotFound",value:function(){De.notFoundRoute=this}},{key:"match",value:function(e){return!p(this,Ke).hasParameters&&e===p(this,Ke).pattern}},{key:"serve",value:function(e){try{if("function"==typeof p(this,Qe))Fe.trace("Serving routing from function. pattern={0}",this.pattern),p(this,Qe).call(this,e);else if("string"==typeof p(this,Qe))Fe.trace("Serving routing from fragment ID. pattern={0} fragment={1}",this.pattern,p(this,Qe)),Oe(p(this,Qe)).render(De.target);else if(Oe.isFragment(p(this,Qe)))Fe.trace("Serving routing from fragment instance. pattern={0}",this.pattern),p(this,Qe).render(De.target);else{if("function"!=typeof p(this,Qe).serve)throw Error("apice.router.invalid_action[".concat(this.pattern,"]"));Fe.trace("Serving routing from serviced instance. pattern={0}",this.pattern),p(this,Qe).serve()}}catch(e){$.render({module:Ie,message:"An error has occurred trying to serve the resource. Please contact technical support without closing this screen",code:"apice.router.serve_error[".concat(this.pattern,"]"),cause:e},De.target)}}}]),e}();Be.register=function(e,t){Fe.debug("Registering route. pattern="+e);var n=new Ye(e,t);return De.routes.push(n),n},Be.match=function(e){if(!e||"string"!=typeof e)return null;for(var t=0;t<De.routes.length;t++){var n=De.routes[t];if(!0===n.match(e))return n}return null},Be.hash=function(){var e=window.location.hash;return e.startsWith("#")&&(e=e.substr(1)),e},Be.start=function(){return Fe.debug("Starting Apice router"),C.addListener(window,"hashchange",(function(){Ue("hashchange")})),C.documentReady((function(){Ue("routerstart")})),Be},Be.target=function(){if(0===arguments.length)return De.target;var e=arguments[0];if(e?(De.target=z(e),De.target||Fe.error("apice.router.target_notfound[".concat(e,"]"))):De.target=null,!De.target){Fe.info("Using default routing target container");var t=document.getElementById("apc-router-container");t||((t=document.createElement("div")).id="apc-router-container",document.body.appendChild(t)),De.target=z(t)}return Be};var Ze={},et={},tt=k.getLogger("apice.ui.toast");function nt(){var e=document.getElementById("apc-toast-container");return e||((e=document.createElement("div")).id="apc-toast-container",document.body.appendChild(e)),e}et.defaultTitle={},et.defaultTitle.error="Attention!",et.defaultTitle.warn="Warning!",et.defaultTitle.info="Information",et.defaultTitle.success="Sucess!";var it=new WeakMap,rt=new WeakMap,ot=new WeakMap,at=new WeakMap,st=new WeakMap,ct=new WeakMap,lt=new WeakSet,ut=new WeakSet,ht=new WeakSet,dt=new WeakSet,ft=function(){function e(n){t(this,e),dt.add(this),ht.add(this),ut.add(this),lt.add(this),it.set(this,{writable:!0,value:void 0}),rt.set(this,{writable:!0,value:void 0}),ot.set(this,{writable:!0,value:void 0}),at.set(this,{writable:!0,value:void 0}),st.set(this,{writable:!0,value:void 0}),ct.set(this,{writable:!0,value:void 0}),v(this,it,n.style),v(this,rt,{text:n.title}),v(this,ot,{text:n.message}),v(this,at,{resource:n.icon}),v(this,ct,n.dismiss),y(this,dt,yt).call(this)}return i(e,[{key:"title",get:function(){return p(this,rt).text||!1===p(this,rt).text?p(this,rt).text:et.defaultTitle[p(this,it)]}},{key:"message",get:function(){return p(this,ot).text}},{key:"dismiss",value:function(){var e=this;p(this,st)&&(p(this,st).style.animationName="bounce-out",setTimeout((function(){p(e,st).parentElement.removeChild(p(e,st)),v(e,st,null)}),500))}},{key:"appendTo",value:function(e){e.insertBefore(p(this,st),e.firstChild)}}]),e}();function pt(){var e=this.title;e?(p(this,rt).box||(p(this,rt).box=document.createElement("div"),p(this,rt).box.className="apc-header",p(this,st).appendChild(p(this,rt).box)),p(this,rt).box.style.display="block",p(this,rt).box.innerHTML=e):p(this,rt).box&&(p(this,rt).box.style.display="none")}function vt(){p(this,ot).box||(p(this,ot).box=document.createElement("div"),p(this,ot).box.className="apc-body",p(this,st).appendChild(p(this,ot).box)),p(this,ot).box.innerHTML=this.message}function gt(){p(this,at).resource?(p(this,at).box||(p(this,at).box=document.createElement("div"),p(this,at).box.className="apc-icon",p(this,st).appendChild(p(this,at).box)),!0===p(this,at).resource&&(p(this,at).box.innerHTML="&nbsp;")):p(this,at).box&&(p(this,at).box.style.display="none")}function yt(){var e=this;p(this,st)||v(this,st,document.createElement("div")),p(this,st).className="apc-toast apc-"+p(this,it),y(this,ht,gt).call(this),y(this,lt,pt).call(this),y(this,ut,vt).call(this),"number"==typeof p(this,ct)?setTimeout((function(){e.dismiss()}),1e3*p(this,ct)):!0===p(this,ct)&&(p(this,st).onclick=function(){e.dismiss()},p(this,st).className+=" apc-clickable")}function mt(t){var n,i={style:t,title:null,message:null,icon:!0,dismiss:!0};1==(arguments.length<=1?0:arguments.length-1)?"object"===e(arguments.length<=1?void 0:arguments[1])?Object.assign(i,arguments.length<=1?void 0:arguments[1]):i.message=arguments.length<=1?void 0:arguments[1]:(i.title=arguments.length<=1?void 0:arguments[1],i.message=arguments.length<=2?void 0:arguments[2],i.dismiss=null===(n=arguments.length<=3?void 0:arguments[3])||void 0===n||n);if(i.message){var r=new ft(i),o=nt();r.appendTo(o)}else tt.warn("A toast has been requested without message. The toast has been ignored")}Ze.error=function(){mt.apply(void 0,["error"].concat(Array.prototype.slice.call(arguments)))},Ze.warn=function(){mt.apply(void 0,["warn"].concat(Array.prototype.slice.call(arguments)))},Ze.info=function(){mt.apply(void 0,["info"].concat(Array.prototype.slice.call(arguments)))},Ze.success=function(){mt.apply(void 0,["success"].concat(Array.prototype.slice.call(arguments)))},Ze.setMax=function(){};var wt={},bt=k.getLogger("apice.ui.form");function kt(e){return"xs"===e.size?" apc-xs":"sm"===e.size?" apc-sm":e.size&&"md"!==e.size?"lg"===e.size?" apc-lg":" apc-xl":" apc-md"}function Et(e,t,n){var i=document.createElement("option");i.innerHTML=t,i.value=n,e.appendChild(i)}function Mt(e,t){if(t)if("function"!=typeof t)t instanceof Promise?t.then((function(t){Mt(e,t)})).catch((function(e){console.err(e)})):(Array.isArray(t)&&0!==t.length||(t=["No data"]),Et(e,"Please select...",""),t.map((function(t){Et(e,t.label,t.value)})));else{var n=t();Mt(e,n)}}var Wt=new WeakMap,Tt=new WeakMap,_t=function(){function e(n,i){t(this,e),Wt.set(this,{writable:!0,value:void 0}),Tt.set(this,{writable:!0,value:void 0}),v(this,Wt,document.createElement("div")),p(this,Wt).className=n+kt({size:i}),p(this,Wt).innerHTML="&nbsp;"}return i(e,[{key:"render",value:function(e){p(this,Tt)||(v(this,Tt,!0),e.appendChild(p(this,Wt)))}}]),e}(),St=new WeakMap,xt=new WeakMap,At=new WeakMap,Lt=function(){function e(n){if(t(this,e),St.set(this,{writable:!0,value:void 0}),xt.set(this,{writable:!0,value:void 0}),At.set(this,{writable:!0,value:void 0}),!n)throw Error("apice.ui.form.button.null_specs");n.id||(n.id="btn_"+J.tinyId()),v(this,St,n.id),v(this,xt,document.createElement("button")),p(this,xt).id=n.id,p(this,xt).className="apc-button",p(this,xt).innerHTML=n.label,v(this,At,!1)}return i(e,[{key:"click",value:function(e){0!==arguments.length?p(this,xt).onclick="function"==typeof e?e:null:p(this,xt).onclick&&p(this,xt).onclick()}},{key:"render",value:function(e){p(this,At)||(v(this,At,!0),e.appendChild(p(this,xt)))}}]),e}(),Ct=new WeakMap,Pt=new WeakMap,Nt=new WeakMap,Rt=function(){function e(){t(this,e),Ct.set(this,{writable:!0,value:void 0}),Pt.set(this,{writable:!0,value:void 0}),Nt.set(this,{writable:!0,value:void 0}),v(this,Ct,[]),v(this,Pt,!1),v(this,Nt,document.createElement("div")),p(this,Nt).className="apc-button-bar"}return i(e,[{key:"addButton",value:function(e){if(e){var t=new Lt(e);return p(this,Ct).push(t),p(this,Pt)&&t.render(),t}}},{key:"render",value:function(e){var t=this;p(this,Pt)||(v(this,Pt,!0),p(this,Ct).map((function(e){return e.render(p(t,Nt))})),e.appendChild(p(this,Nt)))}}]),e}(),qt=new WeakMap,jt=new WeakMap,Ht=new WeakMap,Ot=new WeakMap,It=new WeakMap,Ft=new WeakMap,Bt=new WeakSet,Dt=new WeakSet,Ut=function(){function e(n){var i,r;t(this,e),Dt.add(this),Bt.add(this),qt.set(this,{writable:!0,value:void 0}),jt.set(this,{writable:!0,value:void 0}),Ht.set(this,{writable:!0,value:void 0}),Ot.set(this,{writable:!0,value:void 0}),It.set(this,{writable:!0,value:void 0}),Ft.set(this,{writable:!0,value:void 0}),n.id||(n.id="field_"+J.tinyId()),n.type||(n.type="input"),v(this,qt,n.id),v(this,jt,n.type),v(this,Ht,n.label),v(this,Ot,document.createElement("div")),p(this,Ot).className=(r="apc-field","input"===(i=n).type?r+=" apc-text":"check"===i.type?r+=" apc-check":"select"===i.type&&(r+=" apc-select"),r+kt(i)),y(this,Dt,Gt).call(this,n)}return i(e,[{key:"render",value:function(e){p(this,It)&&p(this,Ot).appendChild(p(this,It)),y(this,Bt,zt).call(this),e.appendChild(p(this,Ot))}}]),e}();function zt(){if(p(this,Ht)){var e=document.createElement("label");e.setAttribute("for",p(this,qt)),e.className="apc-label",e.innerHTML=p(this,Ht),p(this,Ot).appendChild(e)}}function Gt(e){"input"===p(this,jt)?(v(this,It,document.createElement("input")),p(this,It).type="text"):"check"===p(this,jt)?(v(this,It,document.createElement("input")),p(this,It).type="checkbox"):"select"===p(this,jt)&&(v(this,It,document.createElement("select")),Mt(p(this,It),e.source))}var Xt=new WeakMap,Jt=new WeakMap,$t=new WeakMap,Vt=new WeakMap,Kt=new WeakSet,Qt=function(){function e(n){t(this,e),Kt.add(this),Xt.set(this,{writable:!0,value:void 0}),Jt.set(this,{writable:!0,value:void 0}),$t.set(this,{writable:!0,value:void 0}),Vt.set(this,{writable:!0,value:void 0}),v(this,Xt,"form_"+J.tinyId()),v(this,$t,[]),v(this,Jt,!1);var i=document.createElement("div");i.id=p(this,Xt),i.className="apc-form",v(this,Vt,i),z(n).append(i)}return i(e,[{key:"addField",value:function(e){if(e){var t=new Ut(e);return y(this,Kt,Yt).call(this,t),t}}},{key:"addSpacer",value:function(e){var t=new _t("apc-spacer",e);y(this,Kt,Yt).call(this,t)}},{key:"addBreak",value:function(){var e=new _t("apc-break");y(this,Kt,Yt).call(this,e)}},{key:"addButtonBar",value:function(){var e=new Rt;return y(this,Kt,Yt).call(this,e),e}},{key:"addButton",value:function(e){if(e){var t=new Lt(e);return y(this,Kt,Yt).call(this,t),t}}},{key:"render",value:function(){var e=this;if(!p(this,Jt))return v(this,Jt,!0),p(this,$t).map((function(t){return t.render(p(e,Vt))})),this}}]),e}();function Yt(e){e&&(p(this,$t).push(e),p(this,Jt)&&e.render(p(this,Vt)))}function Zt(e){if(!e)return null;if("INPUT"===e.tagName&&"checkbox"===e.type){if(""===e.value||"on"===e.value)return e.checked;if(!e.checked)return null}return e.value}function en(e){var t=e.select("[collect]");if(!t)return bt.warn("apice.form.collect.no_collectable_fields"),{};var n={};return t.each((function(e){!function(e,t){var n=t.getAttribute("collect");if(n){n=n.split(".");for(var i=0;i<n.length;i++){var r=n[i];if(i<n.length-1)e[r]||(e[r]={}),e=e[r];else{var o=Zt(t);null!==o&&(e[r]=o)}}}}(n,e)})),n}wt.create=function(e){return new Qt(e)},wt.collect=function(e){e||(e=document.body);var t=z(e);return t?en(t):(bt.warn("apice.form.collect.unknown_container[".concat(e,"]")),null)};var tn={},nn=k.getLogger("apice.ui.box");function rn(e,t){var n=document.createElement("div");return n.className=e,t&&(n.id=t),n}function on(e,t){var n,i,r=rn("apc-box-content"),o={};return o.header=(n=r,(i=rn("apc-header")).style.display="none",n.appendChild(i),z(i)),o.body=function(e){var t=rn("apc-body");return e.appendChild(t),z(t)}(r),o.footer=function(e,t){var n=rn("apc-footer");return n.style.display="none",t.appendChild(n),z(n)}(0,r),o.box=rn("apc-box",e.id),e.fullscreen?o.box.className+=" apc-full":Array.isArray(e.size)&&(o.box.className+=" apc-non-full",o.box.style.width=e.size[0],o.box.style.height=e.size[1]),o.box.appendChild(r),e.closeable&&function(e,t){var n=rn("apc-closing"),i=document.createElement("button");n.appendChild(i),e.appendChild(n),i.onclick=function(){t.close()}}(o.box,t),o}var an=new WeakMap,sn=new WeakMap,cn=new WeakMap,ln=function(){function e(n){t(this,e),an.set(this,{writable:!0,value:void 0}),sn.set(this,{writable:!0,value:void 0}),cn.set(this,{writable:!0,value:void 0}),n.id||(n.id="box-"+J.tinyId()),v(this,an,n.id),nn.info("Creating box. id={0}",n.id),v(this,cn,-1),v(this,sn,on(n,this))}return i(e,[{key:"appendTo",value:function(e){return z.append(e,p(this,sn).box),-1===p(this,cn)&&v(this,cn,0),this}},{key:"close",value:function(){return 1===p(this,cn)&&(nn.info("Closing box. id={0}",p(this,an)),v(this,cn,0),p(this,sn).box.style.display="none"),this}},{key:"open",value:function(e){var t=this;return new Promise((function(n,i){var r;r=e?t.content(e):Promise.resolve(),-1===!p(t,cn)&&t.appendTo(document.body),r.then((function(){0===p(t,cn)?(v(t,cn,1),p(t,sn).box.style.display="block",setTimeout((function(){n(!0)}),0)):n(!1)})).catch((function(e){i(e)}))}))}},{key:"content",value:function(e){var t=this;return new Promise((function(n,i){m.isPromise(e)?e.then((function(e){t.content(e),n()})).catch((function(e){t.close(),$.render(e),i()})):Oe.isFragment(e)?e.render(p(t,sn).body).then(n).catch(i):(p(t,sn).body.content(e),n())}))}}]),e}();tn.create=function(e){return e?"string"==typeof e&&(e={id:e}):e={},"boolean"!=typeof e.fullscreen&&(e.fullscreen=!1),"boolean"!=typeof e.closeable&&(e.closeable=!1),e.size||e.fullscreen||(e.size=["50%","50%"]),new ln(e)};var un={},hn=k.getLogger("apice.ui.mask");un.show=function(){return hn.trace("Showing protective mask"),new Promise((function(e){var t=document.getElementById("apice-mask");t||((t=document.createElement("div")).id="apice-mask",t.className="apc-mask",document.body.appendChild(t)),t.style.display="block",C.waitAnimation(t,"apc-mask apc-open",e)}))},un.hide=function(){return hn.trace("Hidding protective mask"),new Promise((function(e){var t=document.getElementById("apice-mask");t&&C.waitAnimation(t,"apc-mask apc-closed",(function(){t.style.display="none",e()}))}))};var dn={},fn=k.getLogger("apice.ui.dialog"),pn={};function vn(e,t){var n=document.createElement("div");return n.className=t,e.append(n),z(n)}function gn(e,t){if(1===pn.status)return fn.debug("Dialog container is already visible"),Promise.resolve();pn.status=1,function(){if(!pn.container){fn.debug("Creating the dialog container");var e=document.getElementById("apice-dialog");e||((e=document.createElement("div")).id="apice-dialog",e.className="apc-dialog",document.body.appendChild(e)),e=z(e),pn.container=e,pn.closing=document.createElement("button"),pn.closing.innerHTML="&nbsp;",vn(e,"apc-closing").content(pn.closing),pn.header=vn(e,"apc-header"),pn.body=vn(e,"apc-body"),pn.footer=vn(e,"apc-footer apc-button-bar")}}(),fn.debug("Displaying the dialog container"),t();var n=[];return n[0]=un.show(),n[1]=new Promise((function(t){C.waitAnimation(pn.container,"apc-dialog apc-open apc-"+e.style,t)})),Promise.all(n)}function yn(e,t){if(t){"string"==typeof t&&(t={label:t,close:!0});var n=document.createElement("button");n.className="apc-button",t.className&&(n.className+=" "+t.className),n.innerHTML=t.label,"function"==typeof t.action?n.onclick=function(){!1!==t.action()&&!1!==t.close&&e.close()}:t.close&&(n.onclick=function(){e.close()}),pn.footer.append(n)}}pn.current=null,pn.queue=[],pn.container=null,pn.closing=null,pn.header=null,pn.body=null,pn.footer=null,pn.status=0,pn.titles={},pn.titles.error="Atention!",pn.titles.warn="Warning!",pn.titles.info="Information",pn.titles.success="Success!";var mn=new WeakMap,wn=new WeakMap,bn=new WeakMap,kn=new WeakMap,En=new WeakMap,Mn=new WeakMap,Wn=function(){function e(n){t(this,e),mn.set(this,{writable:!0,value:void 0}),wn.set(this,{writable:!0,value:void 0}),bn.set(this,{writable:!0,value:void 0}),kn.set(this,{writable:!0,value:void 0}),En.set(this,{writable:!0,value:void 0}),Mn.set(this,{writable:!0,value:void 0}),n.id||(n.id="dialog_".concat(J.tinyId())),v(this,mn,n.id),v(this,wn,n.style),v(this,kn,n.title),v(this,En,n.body),v(this,Mn,[]),v(this,bn,{}),p(this,bn).close=[]}return i(e,[{key:"id",get:function(){return p(this,mn)}},{key:"title",get:function(){return p(this,kn)?p(this,kn):pn.titles[p(this,wn)]}},{key:"style",get:function(){return p(this,wn)}},{key:"open",value:function(){var e=this;return pn.current===this?(fn.debug("The dialog instance is already opened. id={0}",this.id),Promise.resolve()):pn.current?(fn.debug("Another dialog instance is opened. The current dialog is queued. id={0}",this.id),new Promise((function(t,n){pn.queue.push({dialog:e,resolve:t,reject:n})}))):(fn.debug("Opening dialog instance. id={0}",this.id),pn.current=this,gn(this,(function(){pn.closing.onclick=function(){e.close()},pn.header.content(e.title),pn.body.content(p(e,En)),pn.footer.content("");for(var t=0;t<p(e,Mn).length;t++){var n=p(e,Mn)[t];yn(e,n)}})))}},{key:"close",value:function(){var e=this;return pn.current!==this?(fn.debug("The dialog cannot be closed because it is not opened. Removing it from the queue. id={0}",this.id),function(e){if(e){for(var t=0;t<pn.queue.length;t++)if(pn.queue[t].dialog===e)return pn.queue.splice(t,1),void fn.debug("The dialog has been removed. id={0}",e.id);fn.warn("The dialog instance could not be removed from the queue since it was not found. id={0}",e.id)}}(this),Promise.resolve()):(fn.debug("Closing dialog. id={0}",this.id),pn.current=null,function(){if(0===pn.status)return fn.debug("Dialog container is already closed"),Promise.resolve();pn.status=0,fn.debug("Closing the dialog container");var e=[];return e[0]=un.hide(),e[1]=new Promise((function(e){C.waitAnimation(pn.container,"apc-dialog apc-closed",(function(){pn.header.content(""),pn.body.content(""),pn.footer.content(""),e()}))})),Promise.all(e)}().then((function(){!function(e){for(var t=0;t<e.length;t++){var n=e[t];try{n()}catch(e){fn.error("An error has occurred trying to execute an event listener",e)}}}(p(e,bn).close),function(){if(0===pn.queue.length)return fn.debug("No more dialogs in the queue"),!1;fn.debug("Opening the next dialog from the queue");var e=pn.queue.shift();e.dialog.open().then(e.resolve).catch(e.reject)}()})))}},{key:"onClose",value:function(e){"function"==typeof e&&p(this,bn).close.push(e)}},{key:"addButton",value:function(e){return e&&p(this,Mn).push(e),this}}]),e}();function Tn(e,t){return"string"==typeof t?t={body:t}:t||(t={}),t.style=e,new Wn(t)}dn.error=function(e){return Tn("error",e)},dn.warn=function(e){return Tn("warn",e)},dn.info=function(e){return Tn("info",e)},dn.success=function(e){return Tn("success",e)};var _n={toast:Ze,form:wt,box:tn,dialog:dn},Sn=0,xn=1,An=6;function Ln(){return!0===arguments[0]?{major:Sn,minor:xn,patch:An}:"v"+Sn+"."+xn+"."+An}return console.log("%cApice Framework ".concat(Ln()),"color: #64dd17;"),{version:Ln,ready:function(e){C.documentReady(e)},logging:k,util:m,events:C,element:z,cookies:b,http:oe,controller:ke,fragment:Oe,router:Be,error:$,ui:_n,form:wt}}();
//# sourceMappingURL=apice.min.js.map
